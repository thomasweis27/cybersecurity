# Incident Response, Forensics, and Recovery
## 12.1 Incident Response
* Incident: a violation of the policies or procedures
* Events: Some occurrence of something happening. An incident is one option for an event
* Security Incident: A security event with a negative adverse effect on a company
* Incident Response: The action to deal with a security incident
* First Responder: The first person on the scene after a security incident has occurred.
* Central Incident Response Team: Members of the IR team are in one central location and deal with all incidents
* Distributed Incident Response Team: The IR team is spread out across an entire company
* Coordinating Team: A Central Incident Response Team that then communicates with all other teams across all locations
* IR Process:
  * Preparation: Defines roles and responsibilities and develop strategies
  * Identification: First Responders used to figure out what happened, the level of impact, and who else to bring in.
  * Containment: Stop the damage from escalating further and prevent future action
  * Eradication: Taking action to mitigate issues and get the business back up and running
  * Recovery: Everything is eradicated and documented and the business is back to running as normal
  * Documentation & Lessons Learned: Happens after the incident to revisit policies and implement other strategies to help prevent future issues
* IR Team Individuals: Members of management, leadership, information security staff members, and technical experts
  * Legal and HR staff will also be needed to mitigate public appearance/legal issues.
</br></br></br>
* Tabletop Exercise: Talking through the process and making sure that people know how to respond to the threat.
* Walkthrough Exercise: Walk through the response process step-by-step
* Simulated Exercises: Can simulate part/full incident - everyone should know of the simulation to prevent accidental legal actions
* Communication Tests: Makes sure that the parties that need to be reached are reached and backup people are identified
* Partial Exercises: Somewhat intrusive and can disrupt some normal operations
* Full Exercise: Most disruptive to normal business, most useful tests over business continuity and disaster recovery plans.
* Plan Review: Plans, the contact information of users and vendors, site access plans, etc. should be reviewed continuously to ensure readiness.
* Intelligence Lifecycles: Direction, Collection, Processing, Analysis, Dissemination, Feedback
* Cyber Kill Chain:
  * Reconnaissance: researching to understand the target
  * Weaponization: Crafts malware to be used against the target.
  * Delivery: Launch malware against a target
  * Exploitation: Expoits the vulnerability to gain access to the target.
  * Installation: Install backdoors to the target
  * Command and Control (C2): Malware opens a command channel for the attacker to use
  * Actions and Objectives: Accomplish the original goals of the attacker.
* Dimond Model: Grid with four points - Adversary, capabilities, Victim, and infrastructure.
* MITRE: Non-profit Organization with federal funding for research across agencies
  * Common Vulnerabilities and Exposures (CVE) Database
  * Common Weakness Enumeration (CWE) Database
  * ATT&CK framework: to help catalog emerging TTPs (Tactics, Technologies, and procedures) in global attacks.
  * ATT&CK procedures: Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential access, lateral movement, Collection, Command and Control, Exfiltration, and Impact.
  * TAXII: Transport protocol allowing the sharing of threat intelligence over HTTPS
  * STIX: Standard format for presenting threat intel info
 
## 12.2 Mitigation of an Incident
* After a security incident, apply mitigation techniques
  * Application Approved Lists (whitelists or allow lists): Companies must review their lists of applications and ensure not used applications are not allowed 
  * Application Deny Lists (Blacklists/block lists): Blocking known bad applications or applications vendors do not want users to access or use bandwidth
  * Quarantine: Anti-virus protection should be set up everywhere and should quarantine possibly dangerous applications/emails
  * Firewall Rules: Check the firewall rules and make sure to block ports, applications, and services that are not needed/potentially dangerous
  * MDM: Revisit MDM policies to ensure issues do not come from the mobile devices entering the workspace.
  * DLP: Revisit the data loss policies and upgrade classifications to data as needed
  * Content/URL Filters: Revisit the content blocked and add/change settings to prevent visitation to these locations.
  * Update or Revoke Certificates: If a certificate is no longer secure/valid, do not use it and revoke the certificate.
  * Isolation: Make sure devices are properly segmented and isolated as needed to prevent issues from spreading. 
  * Segmentation: Ensure networks are properly segmented using VLANs to prevent issues from spreading
  * SOAR: Make sure SOAR IR runbooks and playbooks are up-to-date and ensure the proper steps are taken for data as needed.
    * Runbooks: A set of rules that are mostly automated to respond to threats - these are step-by-step plans for conditions that happen.
    * Playbooks: Step-by-step actions that need to occur within the SOAR process, this is usually done by humans and the playbook is a guide for these users.
   
## 12.3 Log Mamagement
* Gather Data from Vulnerability Scan outputs, SIEM Dashboards, sensor data, and data correlation (combinations of host-based and network-based sensors)
* Sensitivity: Figure out the correct sensitivity for the devices on the network to develop a good baseline.
* Trends: Understand 'normal' data usage for different times and flag events outside of this.
  * Look for trends in antivirus, anti-malware, firewall reports, anti-spam, and system reports
* Alerts: When something is abnormal it is important to alert people that the issue is happening so it can be resolved.
  * Alert Options: Onscreen, email, SMS - different options for different levels of severity.
* Logs: A record kept of actions happening on a network - all organizations should collect, analyze, and preserve security and access logs.
* Firewall logs: Keep track of firewall incidents, and what goes through, and can look for Trojans and other harmful things entering the network.
* System-Level Logs: Events specific to a system or a network of systems including:
  * Login and logout times: The times users connect and disconnect from the network 
  * Login Attempts: If a user is trying to access an account too many times, this could mean hacking is being attempted.
  * Password and account changes: When a user changes their password that should be logged.
  * Privileged-User Events: Events that need elevated privileges should be logged.
  * Assignment of rights, privileges, and permissions: Escalation of privileges for any account should be documented to detect privilege creep.
  * Disabling Accounts: If an account is disabled it should be logged.
  * Deleting Accounts: Removing accounts should be logged.
  * Changes to critical Files and Logs: This should be logged to make sure something is not trying to be covered up.
* Application-level events: File access, error messages, and security violations with apps should be logged.
* User-Level Events: Use of resources, commands and keystrokes, and security violations should be logged to detect abnormalities
* Web Application Firewall (WAF): Firewall for Web applications that can log events of injection, XSS, XSRF/CSRF, and other attacks
* Proxy Logs: Log of data that is being retrieved and who accessed it within the web app.
* DNS LogsL IP addresses making requests to a server should be logged to see frequencies or abnormalities in access. Also, log error messages
* Authentications: To figure out intrusion systems accessed, user authentications should be logged. (login attempts and IP addresses can be really helpful after a security incident.)
* Dump Files: Safed information for data forensics given an event capturing the items in the RAM, error messages on the screen, processes in the background, and log files.
  * This should be collected before going to less volatile data.
* VoIP/SIP: Call data can be logged like numbers, names, and length of calls (not the calls themselves)
* `Syslog`/`rsyslog`/`syslog-ng`: Allows the user to forward logs to a central server for storage and analysis
* `journalctl`: Used to review logs generated by the journal service. (readable format)
* `journalald`: Generates logs in binary formats (computer, nonreadable format)
* NXLog: Open source log collector usable on most OS - collects logs and then forwards them to databases and can back up logs.
* Bandwidth Monitors: Monitors the usage amount of data being used at a given time. Helps establish baselines and find trends. 
* Metadata: Data about data, connected to the data collected itself giving more information during an investigation.
  * Metadata examples: Users, timestamps, GPS locations, phone numbers, device data, descriptions, keywords, created and modified dates

## 12.4 Windows Logging
* Event Forwarding: Configure Specific events on a system that can then be forwarded to another system.
* Collector: Host that receives the log events collected. Consolidates these into one view.
* Collector-initiated subscriptions: Collector computer initiates the collection of events from various computers.
* Source-initiated subscriptions: Initiate the collection of events.
* Windows Event Subscriptions: After the source of the collector has been properly prepared the subscriptions are used to transfer events.
  * Source-Initiated subscriptions: Configure the source computers to forward events to the collector computer.
  * Subscription Configuration: Specify a subscription name, destination log, type, computer or group, and criteria for selecting events to forward.
  * Type of Service Account: Default machine group or specific user service account.
  * Event saving: By default, events are saved in the forwarded Events Log
  * Filters: Without filters, all events are collected
  * Runtime Status: Verifies links to subscriptions
 
## 12.5 Digital Forensics
